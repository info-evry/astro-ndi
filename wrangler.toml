name = "ndi-registration"
main = "dist/_worker.js/index.js"
compatibility_date = "2024-11-01"
compatibility_flags = ["nodejs_compat"]

# Static assets from Astro build
[assets]
bucket = "./dist"

# D1 Database binding
[[d1_databases]]
binding = "DB"
database_name = "ndi-db"
database_id = "3213e689-b0ef-44e7-80e6-657ea8c2fef7"

# KV Namespace for configuration
[[kv_namespaces]]
binding = "CONFIG"
id = "b905d4df752b4dfb80b42b168c7a0904"

# Environment variables
[vars]
ADMIN_EMAIL = "asso@info-evry.fr"
REPLY_TO_EMAIL = "contact@info-evry.fr"
MAX_TEAM_SIZE = "15"
MAX_TOTAL_PARTICIPANTS = "200"
MIN_TEAM_SIZE = "1"

# Secrets (set via wrangler secret put ADMIN_TOKEN)
# ADMIN_TOKEN = "your-secret-token"

# Production environment
[env.production]
name = "ndi-registration"

[[env.production.d1_databases]]
binding = "DB"
database_name = "ndi-db"
database_id = "3213e689-b0ef-44e7-80e6-657ea8c2fef7"

[[env.production.kv_namespaces]]
binding = "CONFIG"
id = "b905d4df752b4dfb80b42b168c7a0904"
